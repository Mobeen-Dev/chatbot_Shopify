<div id="chat-messages"></div>

<script>
function renderCart(cart) {
    const chatMessages = document.getElementById("chat-messages");

    // Helper to add messages
    function addMessage(text, sender = 'bot') {
        const msg = document.createElement('div');
        msg.classList.add('message', `${sender}-message`);
        msg.textContent = text;
        chatMessages.appendChild(msg);
    }

    // Helper to add cart items
    function addCartItem(item) {
        const productDiv = document.createElement('div');
        productDiv.classList.add('message', 'bot-message');

        const productLink = document.createElement('div');
        productLink.classList.add('product-card');

        const title = item.merchandise?.title || "Unnamed product";
        const qty = item.quantity || 1;
        const price = item.price || "";

        productLink.innerHTML = `
            <div class="product-info">
                <h4 class="product-title">${title}</h4>
                <p class="product-price">${price} Ã— ${qty}</p>
            </div>
        `;

        productDiv.appendChild(productLink);
        chatMessages.appendChild(productDiv);
    }

    // Intro
    addMessage("ðŸ›’ Here's your cart:");

    if (!cart.lineItems || cart.lineItems.length === 0) {
        addMessage("Your cart is empty.");
        return;
    }

    // Render items
    cart.lineItems.forEach(item => addCartItem(item));

    // Subtotal
    addMessage(`Subtotal: ${cart.subtotalAmount}`);

    // Checkout link
    const checkoutDiv = document.createElement('div');
    checkoutDiv.classList.add('message', 'bot-message');

    const checkoutLink = document.createElement('a');
    checkoutLink.classList.add('product-card');
    checkoutLink.href = cart.checkoutUrl;
    checkoutLink.target = "_blank";
    checkoutLink.rel = "noopener noreferrer";
    checkoutLink.innerHTML = `
        <div class="product-info">
            <h4 class="product-title">Proceed to Checkout</h4>
            <p class="product-price">${cart.subtotalAmount}</p>
        </div>
    `;

    checkoutDiv.appendChild(checkoutLink);
    chatMessages.appendChild(checkoutDiv);
}

// Example usage
const sampleCart = {
    lineItems: [
        { merchandise: { title: "T-Shirt" }, quantity: 2, price: "$20" },
        { merchandise: { title: "Sneakers" }, quantity: 1, price: "$50" }
    ],
    subtotalAmount: "$90",
    checkoutUrl: "https://example.com/checkout"
};

renderCart(sampleCart);
</script>
